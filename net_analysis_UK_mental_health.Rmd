---
title: "draft_to_learn"
author: "Pietro Olivetti"
date: "2024-07-16"
output: html_document
---

```{r}
library(dplyr)
library(igraph)
library(igraphdata)
library(qgraph)
library(bootnet)
library(corpcor)
library(usethis)
library(MPsychoR)

```

```{r}
data("Rogers")
```


## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
df <- read.csv('data/ESS11.csv')
head(df)

```

# Force-directed plotting with Fruchtermanâ€“Reingold

Most studies on networks in psychopathology have used the Fruchterman-Reingold (FR) algorithm to create graphs. This algorithm, similar to methods by Kamada and Kawai, is like setting up a system of balls connected by stretchy strings. The strings pull connected balls closer, while the other balls push them apart, resulting in a neat graph where nodes are well-spaced and edges are evenly distributed.

Force-directed algorithms aim to produce visually pleasing graphs by minimizing edge crossings and spacing nodes evenly. The goal is not to place the nodes in specific meaningful locations, but to make the network easy to view, showing connections and clusters clearly.

It's important to avoid interpreting the spatial positions of nodes in these graphs, as the placement is not meant to convey specific meanings. Misinterpreting the layout is a common mistake, as it's natural to want to find meaning in the arrangement.

The FR algorithm is the default in the qgraph R package, making it straightforward to use. We will illustrate this with a zero-order correlation network of adults with OCD and depression.

```{r}
zeroorder <- cor(Rogers)

qgraph(zeroorder, layout = "spring", groups = list(Depression = 1:16, OCD = 17:26), color = c("lightblue", "darkblue"))

```



```{r}
df <- read.csv("df_gb.csv")
df <- df[2:15]
head(df)
```

```{r}


df_t <- df %>%
  mutate(fltsd = ifelse(fltsd > 4, NA, fltsd))  %>%
  mutate(fltdpr = ifelse(fltdpr > 4, NA, fltdpr))  %>%
  mutate(cldgng = ifelse(cldgng > 4, NA, cldgng))  %>%
  mutate(slprl = ifelse(slprl > 4, NA, slprl))  %>%
  mutate(cgtsmok = ifelse(cgtsmok > 7, NA, cgtsmok))  %>%
  mutate(alcfreq = ifelse(alcfreq > 7, NA, alcfreq))  %>%
  mutate(dosprt = ifelse(dosprt > 7, NA, dosprt))  %>%
  mutate(ctrlife = ifelse(ctrlife > 10, NA, ctrlife)) %>%
  mutate(cgtsmok = recode(cgtsmok, `7` = 1, `6` = 2, `5` = 3, `4`= 4, `1` = 7, `2` = 6, `3` = 5)) %>%
  mutate(alcfreq = recode(alcfreq, `7` = 1, `6` = 2, `5` = 3, `4`= 4, `1` = 7, `2` = 6, `3` = 5))
  

```

```{r}
df_clean <- na.omit(df_t)

symp <- df_clean[7:14]

zorderdf <- cor(symp)

qgraph(zorderdf, layout = "spring", groups = list(Depression = 1:4, Healthy_elements = 7:8, Unhealthy_elements = 5:6), color = c("darkgrey", "lightblue", "darkred"), nodeNames = colnames(zorderdf))
```
```{r}
write.csv(df_clean, file = "df_gb_clean.csv")
```

```{r}
data("Rogers")
setdiff(names)
```

```{r}
names(Rogers)
```

```{r}

```

```{r}

```

```{r}

```

